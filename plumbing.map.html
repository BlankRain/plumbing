<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>plumbing.map documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Plumbing 0.3.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plumbing</span></div></div></li><li class="depth-2 branch"><a href="plumbing.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fnk</span></div></div></li><li class="depth-3 branch"><a href="plumbing.fnk.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li><li class="depth-3 branch"><a href="plumbing.fnk.pfnk.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pfnk</span></div></a></li><li class="depth-3"><a href="plumbing.fnk.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-2 branch"><a href="plumbing.graph.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>graph</span></div></a></li><li class="depth-2"><a href="plumbing.graph-async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graph-async</span></div></a></li><li class="depth-3"><a href="plumbing.graph.positional.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>positional</span></div></a></li><li class="depth-2 current"><a href="plumbing.map.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>map</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="plumbing.map.html#var-collate"><div class="inner"><span>collate</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-deep-collate"><div class="inner"><span>deep-collate</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-flatten"><div class="inner"><span>flatten</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-get.21"><div class="inner"><span>get!</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-inc-key.21"><div class="inner"><span>inc-key!</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-inc-key-in.21"><div class="inner"><span>inc-key-in!</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-keep-leaves"><div class="inner"><span>keep-leaves</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-keep-leaves-and-path"><div class="inner"><span>keep-leaves-and-path</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-map-leaves"><div class="inner"><span>map-leaves</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-map-leaves-and-path"><div class="inner"><span>map-leaves-and-path</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-merge-disjoint"><div class="inner"><span>merge-disjoint</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-merge-with-key"><div class="inner"><span>merge-with-key</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-safe-select-keys"><div class="inner"><span>safe-select-keys</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-topological-sort"><div class="inner"><span>topological-sort</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-unflatten"><div class="inner"><span>unflatten</span></div></a></li><li class="depth-1"><a href="plumbing.map.html#var-update-key.21"><div class="inner"><span>update-key!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">plumbing.map</h2><div class="doc"><pre class="plaintext">Common operations on maps (both Clojure immutable and mutable Java stuff)
</pre></div><div class="public anchor" id="var-collate"><h3>collate</h3><div class="usage"><code>(collate flat-counts)</code></div><div class="doc"><pre class="plaintext">Take a seq of [k v] counts and sum them up into a HashMap on k.
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L149">view source</a></div></div><div class="public anchor" id="var-deep-collate"><h3>deep-collate</h3><div class="usage"><code>(deep-collate nested-counts)</code></div><div class="doc"><pre class="plaintext">Take a seq of [kseq v] counts and sum them up into nested HashMaps
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L157">view source</a></div></div><div class="public anchor" id="var-flatten"><h3>flatten</h3><div class="usage"><code>(flatten m)</code></div><div class="doc"><pre class="plaintext">Transform a nested map into a seq of [keyseq leaf-val] pairs
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L50">view source</a></div></div><div class="public anchor" id="var-get.21"><h3>get!</h3><h4 class="type">macro</h4><div class="usage"><code>(get! m k default-expr)</code></div><div class="doc"><pre class="plaintext">Get the value in java.util.Map m under key k.  If the key is not present,
set the value to the result of default-expr and return it.  Useful for
constructing mutable nested structures on the fly.

(.add ^List (get! m :k (java.util.ArrayList.)) :foo)</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L120">view source</a></div></div><div class="public anchor" id="var-inc-key.21"><h3>inc-key!</h3><div class="usage"><code>(inc-key! m k d)</code></div><div class="doc"><pre class="plaintext">Increment the value in java.util.Map m under key k by double d.
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L133">view source</a></div></div><div class="public anchor" id="var-inc-key-in.21"><h3>inc-key-in!</h3><div class="usage"><code>(inc-key-in! m ks d)</code></div><div class="doc"><pre class="plaintext">Increment the value in java.util.Map m under key-seq ks by double d,
creating and storing HashMaps under missing keys on the path to this leaf.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L140">view source</a></div></div><div class="public anchor" id="var-keep-leaves"><h3>keep-leaves</h3><div class="usage"><code>(keep-leaves f m)</code></div><div class="doc"><pre class="plaintext">Takes a nested map and returns a nested map with the same shape, where each
(non-map) leaf v is transformed to (f v), or removed if it returns nil.
Empty maps produced by this pruning are themselves pruned from the output.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L100">view source</a></div></div><div class="public anchor" id="var-keep-leaves-and-path"><h3>keep-leaves-and-path</h3><div class="usage"><code>(keep-leaves-and-path f m)</code><code>(keep-leaves-and-path f ks m)</code></div><div class="doc"><pre class="plaintext">Takes a nested map and returns a nested map with the same shape, where each
(non-map) leaf v is transformed to (f key-seq v), or removed if it returns nil.
key-seq is the sequence of keys to reach this leaf, starting at the root.
Empty maps produced by this pruning are themselves pruned from the output.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L81">view source</a></div></div><div class="public anchor" id="var-map-leaves"><h3>map-leaves</h3><div class="usage"><code>(map-leaves f m)</code></div><div class="doc"><pre class="plaintext">Takes a nested map and returns a nested map with the same shape, where each
(non-map) leaf v is transformed to (f v).</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L95">view source</a></div></div><div class="public anchor" id="var-map-leaves-and-path"><h3>map-leaves-and-path</h3><div class="usage"><code>(map-leaves-and-path f m)</code><code>(map-leaves-and-path f ks m)</code></div><div class="doc"><pre class="plaintext">Takes a nested map and returns a nested map with the same shape, where each
(non-map) leaf v is transformed to (f key-seq v).
key-seq is the sequence of keys to reach this leaf, starting at the root.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L69">view source</a></div></div><div class="public anchor" id="var-merge-disjoint"><h3>merge-disjoint</h3><div class="usage"><code>(merge-disjoint)</code><code>(merge-disjoint m)</code><code>(merge-disjoint m1 m2)</code><code>(merge-disjoint m1 m2 &amp; maps)</code></div><div class="doc"><pre class="plaintext">Like merge, but throws with any key overlap between maps
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L25">view source</a></div></div><div class="public anchor" id="var-merge-with-key"><h3>merge-with-key</h3><div class="usage"><code>(merge-with-key f &amp; maps)</code></div><div class="doc"><pre class="plaintext">Like merge-with, but the merging function takes the key being merged
as the first argument</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L36">view source</a></div></div><div class="public anchor" id="var-safe-select-keys"><h3>safe-select-keys</h3><div class="usage"><code>(safe-select-keys m ks)</code></div><div class="doc"><pre class="plaintext">Like select-keys, but asserts that all keys are present.
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L18">view source</a></div></div><div class="public anchor" id="var-topological-sort"><h3>topological-sort</h3><div class="usage"><code>(topological-sort child-map &amp; [include-leaves?])</code></div><div class="doc"><pre class="plaintext">Take an adjacency list representation of a graph (a map from node names to
sequences of child node names), and return a topological ordering of the node
names in linear time, or throw an error if the graph is cyclic.
If include-leaves? is false the ordering will only include keys from child-map,
and if true it will also include nodes only named as children in child-map.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L169">view source</a></div></div><div class="public anchor" id="var-unflatten"><h3>unflatten</h3><div class="usage"><code>(unflatten s)</code></div><div class="doc"><pre class="plaintext">Transform a seq of [keyseq leaf-val] pairs into a nested map.
If one keyseq is a prefix of another, you&apos;re on your own.</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L61">view source</a></div></div><div class="public anchor" id="var-update-key.21"><h3>update-key!</h3><div class="usage"><code>(update-key! m k f)</code><code>(update-key! m k f &amp; args)</code></div><div class="doc"><pre class="plaintext">Transform value in java.util.Map m under key k with fn f.
</pre></div><div class="src-link"><a href="http://github.com/prismatic/plumbing/blob/master/src/plumbing/map.cljx#L113">view source</a></div></div></div></body></html>